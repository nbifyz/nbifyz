В современных операционных системах не обойтись без взаимодействия программ с внешней средой и интернетом.  Для этого используется специальные механизмы - порты.

Но порты представляют определённую угрозу. Если в программе есть какая-либо уязвимость, то любой пользователь локальной сети сможет получить доступ к вашему компьютеру, а в некоторых случаях даже к вашей информации. Поэтому нужно быть очень осторожным с открытыми портами. В этой статье мы разберёмся, как посмотреть открытые порты Ubuntu.

-   [Что такое порты и зачем они нужны?](https://losst.pro/otkrytye-porty-ubuntu#%D0%A7%D1%82%D0%BE_%D1%82%D0%B0%D0%BA%D0%BE%D0%B5_%D0%BF%D0%BE%D1%80%D1%82%D1%8B_%D0%B8_%D0%B7%D0%B0%D1%87%D0%B5%D0%BC_%D0%BE%D0%BD%D0%B8_%D0%BD%D1%83%D0%B6%D0%BD%D1%8B "Что такое порты и зачем они нужны?")
-   [Открытые порты Ubuntu](https://losst.pro/otkrytye-porty-ubuntu#%D0%9E%D1%82%D0%BA%D1%80%D1%8B%D1%82%D1%8B%D0%B5_%D0%BF%D0%BE%D1%80%D1%82%D1%8B_Ubuntu "Открытые порты Ubuntu")
    -   [netstat](https://losst.pro/otkrytye-porty-ubuntu#netstat "netstat")
    -   [lsof](https://losst.pro/otkrytye-porty-ubuntu#lsof "lsof")
    -   [ss](https://losst.pro/otkrytye-porty-ubuntu#ss "ss")
    -   [nmap](https://losst.pro/otkrytye-porty-ubuntu#nmap "nmap")
-   [Выводы](https://losst.pro/otkrytye-porty-ubuntu#%D0%92%D1%8B%D0%B2%D0%BE%D0%B4%D1%8B "Выводы")

## Что такое порты и зачем они нужны?

Порты - это более широкое понятие, чем просто возможность подключится к удалённому компьютеру через сеть. Когда процесс хочет обратиться к серверу, ему нужно каким-либо образом идентифицировать, к какому серверу он хочет подключиться. Если мы знаем 32 битный IP-адрес сервера, то мы можем без проблем к нему подключиться.

Но как указать программу, к которой нужно обратиться? Для решения этой проблемы оба протокола UDP и TCP поддерживают систему портов. Порт - это целое число от 1024 до 65535. Все номера до 1024 зарезервированы и используются только определёнными службами, например, 22 - ssh, http - 80, FTP - 21 и так далее.

Таким образом, процесс прослушивает определённый порт на сервере, а клиент, который хочет к нему обратиться, должен знать этот порт. Вся обработка прав доступа к портам в большинстве случаев ложится на процесс, поэтому если в его коде есть уязвимости, то это может стать серьёзной проблемой безопасности.

Существуют не только порты, к которым программы подключаются удалённо, но и локальные порты, используемые программами для общения между собой. В качестве локальных также могут использоваться удалённые.

В Linux существует несколько утилит, которые можно использовать, чтобы посмотреть открытые порты. Одни из них полноценные сетевые сканеры, другие - локальные утилиты, отображающие всю доступную информацию. Рассмотрим основные из них.

### netstat

Это одна из самых старых и популярных утилит для просмотра открытых портов. Мы описывали её в [отдельной статье](https://losst.pro/kak-posmotret-otkrytye-porty-v-linux), а сейчас просто кратко рассмотрим, как с ней работать. Чтобы посмотреть открытые порты, выполните такую команду:

`netstat -ntlp | grep LISTEN`

Опция **\-l** сообщает, что нужно посмотреть прослушиваемые порты, **\-p**  показывает имя программы, **\-t** и **\-u** - отображают TCP и UDP порты, а **\-n** показывает ip адреса в числовом виде. Дальше нужно выбрать только те строки, где встречается слово LISTEN, чтобы найти только прослушиваемые порты.

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-14-52-58-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-14-52-58.png)

Здесь в первом столбце отображается протокол, затем два столбца - это данные, которые нам ничего полезного не говорят, а за ними уже идут локальный и внешний адреса. Если локальный адрес - 127.0.0.1, то это значит, что сервис доступен только на этом компьютере, а значение 0.0.0.0 или :: означает любой адрес, к таким сервисам могут подключаться из сети. В нашем примере это Apache и systemd-resolvd.

### lsof

Утилита **lsof** тоже предназначена для просмотра открытых соединений. Основная ее функция - просмотр открытых файлов, но с её помощью можно посмотреть открытые порты Ubuntu. Используйте такие параметры:

`sudo lsof -nP -i | grep LISTEN`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-06-01-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-06-01.png)

Опции **\-n** и **\-P** указывают, что необходимо отображать не только цифровые имена портов и ip-адреса, но и  имена доменов и сервисов. Опция **\-i** отображает все сетевые подключения, а с помощью **grep** мы фильтруем только те, которые находятся в состоянии прослушивания.

Представление информации немного отличается, но в общем и целом мы видим всё ту же информацию. Кроме неё, здесь ещё отображается имя пользователя, от которого запущен процесс. Вы можете не ограничиваться фильтрами и посмотреть все доступные соединения:

`sudo lsof -nP -i`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-22-57-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-22-57.png)

### ss

[Команда ss](https://losst.pro/monitoring-setevyh-podklyuchenij-v-linux) \- это улучшенная версия **netstat**. Точно так, как для замены **ifconfig** была придумана утилита **ip**, **ss** разработали для замены **netstat**. Команда будет выглядеть следующим образом:

`ss -ltupn`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-26-10-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-26-10.png)Все данные здесь выводятся почти так же, как и в **netstat**, поэтому вы легко во всём разберётесь. В дополнение к выше перечисленным командам: возможно, вам нужно будет посмотреть на правила брандмауэра **iptables,** чтобы понять, какие порты закрыты с его помощью:

`iptables -L`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-42-34-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-15-42-34.png)

В нашем примере нет никаких ограничений. Политика по умолчанию - ACCEPT. На промышленных серверах может применяться политика DENY, а нужные порты будут разрешены с помощью правил.

### nmap

Сетевой сканер **nmap** позволяет проверить список портов Ubuntu так, как бы это делал злоумышленник при попытке атаки на вашу систему. Здесь вы будете видеть все порты, которые видны снаружи. Но для сканирования нужно использовать внешний ip-адрес. Не сетевой ip-адрес провайдера, а адрес вашего компьютера, например, в локальной сети чаще всего используется 192.168.1.2. Посмотреть ip вашего сетевого интерфейса можно с помощью команды **ifconfig**:

`ifconfig`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-14-17-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-14-17.png)

Чтобы просто просканировать открытые порты Ubuntu, будет достаточно выполнить:

`nmap -sT 192.168.1.3`

[![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-13-59-1024x576.png)](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-13-59.png)

Также можно выполнить комплексное сканирование всех уязвимостей. Важно отметить, что команда не находит все уязвимости, а проверяет только самые простые. Для активации этого режима используется опция **\-A**:

`sudo nmap -A 192.168.1.3`

![](https://losst.pro/wp-content/uploads/2017/05/Snimok-ekrana-ot-2017-05-31-16-14-53-1024x576.png)

Как [пользоваться nmap,](https://losst.pro/kak-polzovatsya-nmap-dlya-skanirovaniya-seti) читайте в отдельной статье.

<iframe loading="lazy" title="Сканирование сети при помощи Nmap" width="840" height="473" src="https://www.youtube.com/embed/djf6MRH9nc4?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

## Выводы

В этой статье мы рассмотрели, как проверить порты Ubuntu с помощью нескольких утилит. Все они выводят подробную информацию, но для каждого отдельного случая может лучше подойти только одна из них. Например, проверять, какие порты видят другие компьютеры извне, лучше с помощью **nmap**. А чтобы посмотреть, какие службы или сокеты доступны локально, лучше применять **netstat** или **ss**.

Проверяйте, какие порты открыты, и если они не нужны, то закройте их в брандмауэре или просто отключите сервис. Иначе они ставят под угрозу безопасность вашей системы. Например, у меня на ноутбуке открыт порт SSH, и я не раз наблюдал в логах попытки перебрать пароль от каких-то роутеров из локальной сети. И если даже вас некому ломать, это могут сделать вирусы. Так что будьте осторожны, и не оставляйте открытые порты, если в этом нет необходимости.

<iframe loading="lazy" title="check open and listening ports on Ubuntu 12.04" width="840" height="473" src="https://www.youtube.com/embed/8SyaoVmRXuM?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

Обнаружили ошибку в тексте? Сообщите мне об этом. Выделите текст с ошибкой и нажмите Ctrl+Enter.